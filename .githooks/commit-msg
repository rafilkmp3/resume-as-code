#!/bin/bash
#
# Git commit-msg hook to enforce Conventional Commits
#
# This hook validates commit messages against the Conventional Commits specification:
# https://www.conventionalcommits.org/
#
# Installation:
#   git config core.hooksPath .githooks
#
# Or manually:
#   cp .githooks/commit-msg .git/hooks/commit-msg
#   chmod +x .git/hooks/commit-msg

echo "üîç Validating commit message format..."

# Run the Node.js validation script
node scripts/validate-commit-msg.js "$1"

# Capture exit code
EXIT_CODE=$?

if [ $EXIT_CODE -eq 0 ]; then
    echo "‚úÖ Commit message validation passed"
else
    echo ""
    echo "‚ùå Commit message validation failed"
    echo ""
    echo "üí° Quick examples of valid commit messages:"
    echo "   feat: add user authentication"
    echo "   fix: resolve memory leak in pagination"  
    echo "   docs: update installation guide"
    echo "   feat(api): add OAuth2 support"
    echo "   fix!: remove deprecated authentication method"
    echo ""
    echo "üîß To bypass this check (not recommended):"
    echo "   git commit --no-verify -m 'your message'"
    echo ""
fi

exit $EXIT_CODE